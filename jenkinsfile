pipeline{
    agent any
    tools {
      maven "maven"
      }
    stages {
        stage('Build maven project') {
          steps{
            sh 'mvn clean install package' 
          }
        }
          stage('Test') {
              steps {
                  echo 'testing......'
                  
              }
          }
          stage("SonarQube analysis") {
            def scannerHome = tool 'sonarqube-scanner'
            withSonarQubeEnv('sonarqube') {
              sh """/var/lib/jenkins/tools/hudson.plugins.sonar.SonarRunnerInstallation/sonarqube-scanner/bin/sonar-scanner \
     -D sonar.projectVersion=1.0-SNAPSHOT \
       -D sonar.login=admin \
      -D sonar.password=Naga@308 \
      -D sonar.projectBaseDir=/var/lib/jenkins/workspace/newpipeline/ \
        -D sonar.projectKey=spring-petclinic \
        -D sonar.sourceEncoding=UTF-8 \
        -D sonar.language=java \
        -D sonar.sources=spring-petclinic/src/main \
        -D sonar.tests=spring-petclinic/src/test \
        -D sonar.host.url=http://52.73.254.246:9000/"""
            }
          }
        }
      

    }
}